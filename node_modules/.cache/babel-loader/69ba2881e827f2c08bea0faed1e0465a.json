{"ast":null,"code":"import _slicedToArray from\"/Users/seenanair/Desktop/CCDC_Demo/ccdc-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{InfoBox}from'../Components/InfoBox/InfoBox';import{Table}from'../Components/Table/Table';import Wrapper from'../utils/Wrapper';import{useFetch}from'../hooks/useFetch';import classes from'./DataBuilder.module.css';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var DataBuilder=function DataBuilder(){var _React$useState=React.useState(0),_React$useState2=_slicedToArray(_React$useState,2),selectedDataIndex=_React$useState2[0],setSelectedDataIndex=_React$useState2[1];//Custom hook to fetch data\nvar _useFetch=useFetch(\"https://api.test.datacite.org/dois?query=prefix:10.5517\"),data=_useFetch.data,loading=_useFetch.loading,error=_useFetch.error;var getData=function getData(data){if(data&&data.data&&data.data.length>0)return data.data;else return[];};var ccdData=React.useMemo(function(){return getData(data);},[data]);//Create table structure\nvar prepareSummaryTableColumns=function prepareSummaryTableColumns(){return[{Header:function Header(){return'Summary';},id:'axes-header',columns:['id','title'].map(function(th,idx){return{Header:idx===0?th.toUpperCase():th.charAt(0).toUpperCase()+th.slice(1),accessor:th};})}];};//Fomat data to display as summary\nvar formatSummaryData=function formatSummaryData(data){return data.map(function(entry){return{id:entry.id,title:entry.attributes.titles[0].title};});};//Format data to display as content\nvar formatContentData=function formatContentData(data){return{'Publication Year':data[selectedDataIndex].attributes.publicationYear,Publisher:data[selectedDataIndex].attributes.publisher,Subjects:data[selectedDataIndex].attributes.subjects.map(function(val){return val['subject'];}),URL:data[selectedDataIndex].attributes.url};};//Create content\nvar prepareContent=function prepareContent(data){if(selectedDataIndex>=0){var formattedData=formatContentData(data);var detailsArray=[];for(var _i=0,_Object$entries=Object.entries(formattedData);_i<_Object$entries.length;_i++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),k=_Object$entries$_i[0],v=_Object$entries$_i[1];detailsArray.push([k,v]);}return/*#__PURE__*/_jsx(\"ul\",{children:detailsArray.map(function(row,indx){return/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsxs(\"h2\",{children:[row[0],\" \"]}),/*#__PURE__*/_jsx(\"ul\",{children:Array.isArray(row[1])?row[1].map(function(val,i){return/*#__PURE__*/_jsx(\"li\",{children:val},val+i);}):indx===detailsArray.length-1?/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{href:row[1],children:row[1]})}):/*#__PURE__*/_jsx(\"li\",{children:row[1]})})]},indx.toString());})});}else return'';};//Handle selection in summary table\nvar handleTableRowClick=function handleTableRowClick(indx){setSelectedDataIndex(indx);};return/*#__PURE__*/_jsx(Wrapper,{children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:classes.Loader}),/*#__PURE__*/_jsx(\"div\",{className:classes.ContainerText,children:\"Loading\"})]}):ccdData.length>0?Object.keys(error).length!==0?/*#__PURE__*/_jsx(\"div\",{children:\" Error while fetching data\"}):/*#__PURE__*/_jsxs(\"div\",{className:classes.Conatiner,children:[/*#__PURE__*/_jsx(\"div\",{className:classes.Left,children:/*#__PURE__*/_jsx(Table,{columns:prepareSummaryTableColumns(),data:formatSummaryData(ccdData),selectedRow:0,pageIndexValue:0,pageSizeValue:20,onRowClick:handleTableRowClick})}),/*#__PURE__*/_jsx(\"div\",{className:classes.Right,children:/*#__PURE__*/_jsx(InfoBox,{title:'Details',children:prepareContent(ccdData)})})]}):''});};","map":{"version":3,"sources":["/Users/seenanair/Desktop/CCDC_Demo/ccdc-app/src/DataBuilder/DataBuilder.tsx"],"names":["React","InfoBox","Table","Wrapper","useFetch","classes","DataBuilder","useState","selectedDataIndex","setSelectedDataIndex","data","loading","error","getData","length","ccdData","useMemo","prepareSummaryTableColumns","Header","id","columns","map","th","idx","toUpperCase","charAt","slice","accessor","formatSummaryData","entry","title","attributes","titles","formatContentData","publicationYear","Publisher","publisher","Subjects","subjects","val","URL","url","prepareContent","formattedData","detailsArray","Object","entries","k","v","push","row","indx","Array","isArray","i","toString","handleTableRowClick","Loader","ContainerText","keys","Conatiner","Left","Right"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { InfoBox } from '../Components/InfoBox/InfoBox';\nimport { Table } from '../Components/Table/Table';\nimport Wrapper from '../utils/Wrapper';\nimport { useFetch } from '../hooks/useFetch';\nimport classes from './DataBuilder.module.css';\n\nexport const DataBuilder = () => {\n    const [selectedDataIndex, setSelectedDataIndex] = React.useState(0);\n\n    //Custom hook to fetch data\n    const { data, loading, error } = useFetch(`https://api.test.datacite.org/dois?query=prefix:10.5517`);\n\n    const getData = (data: any): [] => {\n        if (data && data.data && data.data.length > 0) return data.data;\n        else return [];\n    };\n\n    const ccdData = React.useMemo(() => getData(data), [data]);\n\n    //Create table structure\n    const prepareSummaryTableColumns = () => {\n        return [\n            {\n                Header: () => 'Summary',\n                id: 'axes-header',\n                columns: ['id', 'title'].map((th, idx) => {\n                    return {\n                        Header: idx === 0 ? th.toUpperCase() : th.charAt(0).toUpperCase() + th.slice(1),\n                        accessor: th,\n                    };\n                }),\n            },\n        ];\n    };\n\n    //Fomat data to display as summary\n    const formatSummaryData = (data: any) => {\n        return data.map((entry: any) => ({ id: entry.id, title: entry.attributes.titles[0].title }));\n    };\n\n    //Format data to display as content\n    const formatContentData = (data: any) => {\n        return {\n            'Publication Year': data[selectedDataIndex].attributes.publicationYear,\n            Publisher: data[selectedDataIndex].attributes.publisher,\n            Subjects: data[selectedDataIndex].attributes.subjects.map((val: any) => val['subject']),\n            URL: data[selectedDataIndex].attributes.url,\n        };\n    };\n\n    //Create content\n    const prepareContent = (data: any) => {\n        if (selectedDataIndex >= 0) {\n            const formattedData = formatContentData(data);\n            const detailsArray: any[] = [];\n            for (const [k, v] of Object.entries(formattedData)) {\n                detailsArray.push([k, v]);\n            }\n            return (\n                <ul>\n                    {detailsArray.map((row, indx) => {\n                        return (\n                            <li key={indx.toString()}>\n                                <h2>{row[0]} </h2>\n                                <ul>\n                                    {Array.isArray(row[1]) ? (\n                                        row[1].map((val, i) => <li key={val + i}>{val}</li>)\n                                    ) : indx === detailsArray.length - 1 ? (\n                                        <li>\n                                            <a href={row[1]}>{row[1]}</a>\n                                        </li>\n                                    ) : (\n                                        <li>{row[1]}</li>\n                                    )}\n                                </ul>\n                            </li>\n                        );\n                    })}\n                </ul>\n            );\n        } else return '';\n    };\n    //Handle selection in summary table\n    const handleTableRowClick = (indx: number) => {\n        setSelectedDataIndex(indx);\n    };\n\n    return (\n        <Wrapper>\n            {loading ? (\n                <>\n                    <div className={classes.Loader} />\n                    <div className={classes.ContainerText}>Loading</div>\n                </>\n            ) : ccdData.length > 0 ? (\n                Object.keys(error).length !== 0 ? (\n                    <div> Error while fetching data</div>\n                ) : (\n                    <div className={classes.Conatiner}>\n                        <div className={classes.Left}>\n                            <Table\n                                columns={prepareSummaryTableColumns()}\n                                data={formatSummaryData(ccdData)}\n                                selectedRow={0}\n                                pageIndexValue={0}\n                                pageSizeValue={20}\n                                onRowClick={handleTableRowClick}\n                            />\n                        </div>\n                        <div className={classes.Right}>\n                            <InfoBox title={'Details'}>{prepareContent(ccdData)}</InfoBox>\n                        </div>\n                    </div>\n                )\n            ) : (\n                ''\n            )}\n        </Wrapper>\n    );\n};\n"]},"metadata":{},"sourceType":"module"}